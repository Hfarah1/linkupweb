<h2>{{ event.titre }}</h2>
<p>{{ event.description }}</p>
<p class="fw-bold" style="font-size: 1.3em; color: #1976d2; margin-top: 12px; margin-bottom: 24px;">
    ⭐ Moyenne&nbsp;: <span style="font-weight: bold; color: #222;">{{ moyenne }}</span> / 5
    <span style="font-size: 0.9em; color: #555;">(basée sur {{ n }} avis)</span>
</p>

<div class="rating-bars">
    {% set bars = {
        5: n5,
        4: n4,
        3: n3,
        2: n2,
        1: n1
    } %}
    {% for i in 5..1 %}
        {% set percent = n > 0 ? (bars[i] / n * 100)|round : 0 %}
        <div class="row align-items-center mb-1">
            <div class="col-1">{{ i }} ★</div>
            <div class="col-9">
                <div class="bar-container bg-light rounded" style="height: 18px;">
                    <div style="width: {{ percent }}%; height: 100%; background-color: {% if i == 5 %}#04AA6D{% elseif i == 4 %}#2196F3{% elseif i == 3 %}#00bcd4{% elseif i == 2 %}#ff9800{% else %}#f44336{% endif %};"></div>
                </div>
            </div>
            <div class="col-2 text-end">{{ bars[i] }}</div>
        </div>
    {% endfor %}
</div>
<style>
.bar-container {
    width: 100%;
    background-color: #f1f1f1;
    border-radius: 4px;
}
</style>

{% if event.imagePath %}
    <div style="text-align: center; margin: 32px 0;">
        <img src="{{ asset('uploads/' ~ event.imagePath) }}" alt="Image de l'événement" style="max-width: 350px; max-height: 300px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
    </div>
{% endif %}

<div class="comments-section" style="margin-top: 40px;">
    <h3>Commentaires</h3>
    <div style="display: flex; flex-direction: column; gap: 16px;">
        {% for rating in ratings %}
            {% if rating.commentaire %}
                <div style="max-width: 400px; align-self: flex-start; background: #f1f1f1; border-radius: 16px; padding: 16px 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); position: relative;">
                    <div style="font-size: 1.1em; color: #333;">{{ rating.commentaire }}</div>
                    <div style="font-size: 0.95em; color: #888; margin-top: 8px;">
                        Note : <span style="color: #2196F3; font-weight: bold;">{{ rating.note }} ★</span>
                    </div>
                </div>
            {% endif %}
        {% else %}
            <div>Aucun commentaire pour cet événement.</div>
        {% endfor %}
    </div>
</div>

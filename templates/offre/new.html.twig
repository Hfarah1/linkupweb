{% extends 'base.html.twig' %}

{% block title %}Nouvelle Offre{% endblock %}

{% block content %}
    <!-- Single Page Header start -->
    <div class="container-fluid page-header py-5">
        <h1 class="text-center text-white display-6">Créer une Nouvelle Offre d'Emploi</h1>
        <ol class="breadcrumb justify-content-center mb-0">
            <li class="breadcrumb-item"><a href="#">Accueil</a></li>
            <li class="breadcrumb-item"><a href="#">Offres</a></li>
            <li class="breadcrumb-item active text-white">Nouvelle Offre</li>
        </ol>
    </div>
    <!-- Single Page Header End -->

    <!-- Checkout Page Start -->
    <div class="container-fluid py-5">
        <div class="container py-5">
            <h1 class="mb-4">Détails de l'Offre</h1>
            
            <div class="row g-5">
                <div class="col-12">
                    {{ form_start(form, {'attr': {'class': 'needs-validation', 'novalidate': 'novalidate', 'enctype': 'multipart/form-data'}}) }}
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-item w-100">
                                {{ form_label(form.titre, 'Titre du Poste*', {'label_attr': {'class': 'form-label my-3'}}) }}
                                {{ form_widget(form.titre, {'attr': {
                                    'class': 'form-control',
                                    'placeholder': 'Ex: Développeur Symfony Senior'
                                }}) }}
                                {{ form_errors(form.titre) }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-item w-100">
                                {{ form_label(form.type_contrat, 'Type de Contrat*', {'label_attr': {'class': 'form-label my-3'}}) }}
                                {{ form_widget(form.type_contrat, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.type_contrat) }}
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-item w-100">
                                {{ form_label(form.gouvernorat, 'Gouvernorat*', {'label_attr': {'class': 'form-label my-3'}}) }}
                                {{ form_widget(form.gouvernorat, {'attr': {
                                    'class': 'form-control',
                                    'placeholder': 'Ex: Tunis'
                                }}) }}
                                {{ form_errors(form.gouvernorat) }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-item w-100">
                                {{ form_label(form.ville, 'Ville*', {'label_attr': {'class': 'form-label my-3'}}) }}
                                {{ form_widget(form.ville, {'attr': {
                                    'class': 'form-control',
                                    'placeholder': 'Ex: Ariana'
                                }}) }}
                                {{ form_errors(form.ville) }}
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-item">
                        {{ form_label(form.description, 'Description*', {'label_attr': {'class': 'form-label my-3'}}) }}
                        {{ form_widget(form.description, {'attr': {
                            'class': 'form-control',
                            'rows': 5,
                            'placeholder': 'Décrivez en détail le poste et les missions'
                        }}) }}
                        {{ form_errors(form.description) }}
                    </div>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-item w-100">
                                {{ form_label(form.organisation, 'Organisation*', {'label_attr': {'class': 'form-label my-3'}}) }}
                                {{ form_widget(form.organisation, {'attr': {
                                    'class': 'form-control',
                                    'placeholder': 'Nom de votre entreprise/organisation'
                                }}) }}
                                {{ form_errors(form.organisation) }}
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-item w-100">
                                {{ form_label(form.logoFile, 'Logo de l\'Organisation', {'label_attr': {'class': 'form-label my-3'}}) }}
                                <div class="custom-file">
                                    {{ form_widget(form.logoFile, {'attr': {
                                        'class': 'form-control',
                                        'onchange': 'previewImage(this)'
                                    }}) }}
                                    {{ form_errors(form.logoFile) }}
                                </div>
                                <div class="mt-2" id="imagePreview" style="display:none;">
                                    <img id="preview" src="#" alt="Aperçu du logo" class="img-thumbnail" style="max-width: 150px; max-height: 150px;">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-item w-100">
                                {{ form_label(form.salaire, 'Salaire (optionnel)', {'label_attr': {'class': 'form-label my-3'}}) }}
                                {{ form_widget(form.salaire, {'attr': {
                                    'class': 'form-control',
                                    'placeholder': 'Ex: 2500.00'
                                }}) }}
                                {{ form_errors(form.salaire) }}
                            </div>
                        </div>
                    </div>

                    <div class="form-item">
                        {{ form_label(form.categorie, 'CATÉGORIE*', {'label_attr': {'class': 'form-label my-3 fw-bold'}}) }}
                        {{ form_widget(form.categorie, {'attr': {'class': 'form-control'}}) }}
                        {{ form_errors(form.categorie) }}
                    </div>
                    
                    <div class="form-item">
                        {{ form_label(form.competences_requises, 'Compétences Requises (optionnel)', {'label_attr': {'class': 'form-label my-3'}}) }}
                        {{ form_widget(form.competences_requises, {'attr': {
                            'class': 'form-control',
                            'rows': 3,
                            'placeholder': 'Listez les compétences et qualifications nécessaires'
                        }}) }}
                        {{ form_errors(form.competences_requises) }}
                    </div>
                    
                    <div class="row g-4 text-center align-items-center justify-content-center pt-4">
                        <button type="submit" class="btn border-secondary py-3 px-4 text-uppercase w-100 text-primary">
                            {{ button_label|default('CRÉER L\'OFFRE') }}
                        </button>
                    </div>
                    
                    {{ form_end(form) }}
                    
                    <div class="text-center mt-3">
                        <a href="{{ path('app_offre_index') }}" class="btn btn-outline-secondary">Retour à la liste</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Checkout Page End -->

    <script>
        function previewImage(input) {
            const preview = document.getElementById('preview');
            const previewContainer = document.getElementById('imagePreview');
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    previewContainer.style.display = 'block';
                }
                
                reader.readAsDataURL(input.files[0]);
            } else {
                preview.src = '#';
                previewContainer.style.display = 'none';
            }
        }
    </script>
{% endblock %}